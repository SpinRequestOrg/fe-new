import{_ as vt}from"./DVx_XNg2.js";import{_ as yt}from"./Cpev-P7o.js";import{h as F,j as g,o as u,p as N,w as n,b as s,n as e,c as f,a as t,d as R,A as ht,B as bt,C as xt,D as Ct,k as St,r as kt,m as Ft,t as m,z,F as lt,E as dt,v as wt,G as Tt,H as Et,I as Mt,_ as $t}from"./C9o7SX3v.js";import{_ as zt}from"./DNsd-lev.js";import{_ as Rt}from"./DAO5HDyR.js";import{_ as Nt}from"./MD9yZO5Y.js";import{C as At,p as Lt,a as Bt,b as Ht,P as It,c as Pt,L as Dt,d as Ot,e as Yt}from"./DY9Uf1UT.js";import{u as ut,p as Ut}from"./BgH6YnCR.js";import{u as Vt,a as qt,s as Wt}from"./De8_zekx.js";import{u as jt}from"./CorZQDxr.js";import{C as Gt}from"./U04HOykY.js";import{C as Xt}from"./DSaGwqIE.js";import"./CEjNp6Up.js";import"./Cpj98o6Y.js";const A=F({__name:"line-graph",props:{history:{},type:{}},setup(x){At.register(Lt,Bt,Ht,It,Pt,Dt,Ot);const i=x,o=g(()=>{var d;return(d=i.history)!=null&&d.length?[...i.history].map(r=>{const[c,b]=ut(r.created_at,"H_m").value.split("_").map(Number),E=(c*60+b)/1440;return{...r,x:E,y:Number(r.new_price)}}).sort((r,c)=>c.x-r.x).filter(r=>r.new_price!==r.old_price):[]}),v=g(()=>o.value.filter(d=>d.type==="hype")),C=g(()=>o.value.filter(d=>d.type==="song")),h=g(()=>{switch(i.type){case"both":return[{label:"Hype",data:[...v.value],borderColor:"#FFEE99",borderWidth:1,backgroundColor:"#FFEE99",tension:.5},{label:"Song",data:[...C.value],borderColor:"#FF99F1",borderWidth:1,tension:.5,backgroundColor:"#FF99F1"}];case"hype":return[{label:"Hype",data:[...v.value],borderColor:"#FFEE99",borderWidth:1,backgroundColor:"#FFEE99",tension:.5}];default:return[{label:"Song",data:[...C.value],borderColor:"#FF99F1",borderWidth:1,tension:.5,backgroundColor:"#FF99F1"}]}}),w=g(()=>({datasets:[...h.value]})),T=g(()=>({scales:{x:{type:"linear",ticks:{callback(d){const r=Math.round(d*1440),c=Math.floor(r/60),b=r%60;return`${String(c).padStart(2,"0")}:${String(b).padStart(2,"0")}`}}}},plugins:{tooltip:{backgroundColor:"#fff",titleColor:"#000",titleFont:{weight:400,size:15},titleMarginBottom:10,bodyColor:"#000",boxPadding:10,padding:10,caretSize:10,cornerRadius:14,callbacks:{title(d){const r=d[0].parsed.x,c=Math.round(r*1440),b=Math.floor(c/60),E=c%60;return`${String(b).padStart(2,"0")}:${String(E).padStart(2,"0")}`}}}}}));return(d,r)=>{const c=Nt;return u(),N(c,null,{default:n(()=>[s(e(Yt),{data:e(w),options:e(T)},null,8,["data","options"])]),_:1})}}}),Jt=F({__name:"all",props:{history:{}},setup(x){return(i,o)=>(u(),f("div",null,[s(A,{history:i.history,type:"both"},null,8,["history"])]))}}),Kt=F({__name:"hypes",props:{history:{}},setup(x){return(i,o)=>(u(),f("div",null,[s(A,{history:i.history,type:"hype"},null,8,["history"])]))}}),Qt=F({__name:"song",props:{history:{}},setup(x){return(i,o)=>(u(),f("div",null,[s(A,{history:i.history,type:"song"},null,8,["history"])]))}}),Zt={class:"flex items-center justify-between"},te=F({__name:"tab",props:{history:{}},setup(x){return(i,o)=>{const v=ht,C=bt,h=xt,w=Ct;return u(),N(w,{"default-value":"all"},{default:n(()=>[t("div",Zt,[o[3]||(o[3]=t("div",{class:"text-lg font-semibold"},"Price history",-1)),s(C,{class:"rounded-full flex text-sm p-1 bg-background/20"},{default:n(()=>[s(v,{value:"all",class:"rounded-[inherit] min-w-[45px] px-2 py-1 hover:bg-secondary data-[state='active']:bg-primary"},{default:n(()=>o[0]||(o[0]=[R(" All ")])),_:1}),s(v,{value:"songs",class:"rounded-[inherit] min-w-[45px] px-2 py-1 hover:bg-secondary data-[state='active']:bg-primary"},{default:n(()=>o[1]||(o[1]=[R(" Songs ")])),_:1}),s(v,{value:"hypes",class:"rounded-[inherit] min-w-[45px] px-2 py-1 hover:bg-secondary data-[state='active']:bg-primary"},{default:n(()=>o[2]||(o[2]=[R(" Hypes ")])),_:1})]),_:1})]),s(h,{value:"all"},{default:n(()=>[s(Jt,{history:i.history},null,8,["history"])]),_:1}),s(h,{value:"songs"},{default:n(()=>[s(Qt,{history:i.history},null,8,["history"])]),_:1}),s(h,{value:"hypes"},{default:n(()=>[s(Kt,{history:i.history},null,8,["history"])]),_:1})]),_:1})}}}),ee={class:"container pb-20 pt-10"},se={class:"text-3xl font-semibold mb-1"},oe={class:"space-y-4 mt-6"},ae={class:"p-2 sm:p-4 rounded-xl border bg-white/5 grid gap-y-4 md:grid-cols-[2fr_3fr]"},ne={class:"space-y-2"},re={class:"text-2xl md:text-3xl lg:text-4xl font-bold tabular-nums"},ie={class:"space-y-4 pt-4 border-t md:pl-6 md:pt-0 md:border-t-0 md:border-l border-muted-foreground/20"},le={class:"grid grid-cols-[30px_60px_110px_130px] items-center gap-x-2"},de={class:"aspect-square rounded-full bg-[#FF99F1]/10 relative"},ue={class:"text-muted-foreground"},ce={class:"tabular-nums text-muted-foreground"},pe={class:"grid grid-cols-[30px_60px_110px_130px] items-center gap-x-2"},me={class:"aspect-square rounded-full bg-[#FF99F1]/10 relative"},_e={class:"text-muted-foreground"},ge={class:"tabular-nums text-muted-foreground"},fe={class:"grid grid-cols-[repeat(auto-fit,_minmax(230px,_1fr))] gap-4"},ve={class:"space-y-px"},ye={class:"text-muted-foreground"},he={class:"rounded-3xl border p-4 bg-white/5"},be={class:"flex justify-between items-center mb-4"},xe={class:"grid grid-cols-[repeat(auto-fit,_minmax(330px,_1fr))] gap-6"},Ce={class:"text-foreground/80"},Se={key:0,class:"p-8 text-center col-span-full"},ke={class:"rounded-3xl border p-4 bg-white/5",id:"PRICE-HISTORY"},Fe={class:"grid grid-cols-[1fr,_auto,_auto,_auto] gap-4 items-center",id:"ACTION-ROW"},we="https://dev.spinrequest.com",Oe=F({__name:"event-earnings",setup(x){const i=St(),{data:o,error:v,status:C,refresh:h}=jt(`/events/receipt/${i.params.id}`),w=g(()=>{var y,k,$,M;const l=new Date,a={name:"Duration",value:Mt(((y=o.value)==null?void 0:y.data.event.start_date)??l,((k=o.value)==null?void 0:k.data.event.end_date)??l)},S={name:"Location",value:($=o.value)==null?void 0:$.data.event.address},_={name:"Date",value:ut((M=o.value)==null?void 0:M.data.event.start_date,"dddd, MMMM D, YYYY")};return[a,S,_]}),T=kt(!1),d=l=>{var a,S,_;Wt(l,`spin-event-summary-${((_=(S=(a=o.value)==null?void 0:a.data)==null?void 0:S.event)==null?void 0:_.title)??""}`)},{converting:r,convertNodeToImage:c}=Vt("#EVENT_SUMMARY",d,["PRICE-HISTORY","SHARE-BUTTON","ACTION-ROW"]),b=async()=>{T.value=!0,c(),await Ut(1),T.value=!1},E=g(()=>"I just hosted an event on Spin request. Follow me here and put on my post notifcation"),ct=g(()=>`${we}`),{copyLink:pt,copied:mt,whatsappShareLink:_t,twitterShareLink:gt,externalNavigate:L}=qt(ct,E);return Ft({title:"Event Earnings"}),(l,a)=>{const S=vt,_=yt,y=$t,k=zt,$=Rt;return u(),f("div",ee,[s(S,{class:"fixed top-24",to:"/dashboard"}),s($,{loading:e(C)==="pending",error:e(v)},{default:n(()=>{var M,B,H,I,P,D,O,Y,U,V,q,W,j,G,X,J,K,Q,Z,tt,et,st,ot,at,nt,rt,it;return[t("div",{class:Tt(("cn"in l?l.cn:e(Et))(e(T)?"bg-background w-[850px]":" bg-white/5 max-w-full w-[867px] mx-auto","rounded-3xl border p-4 sm:p-10")),id:"EVENT_SUMMARY"},[t("div",se,m((M=e(o))==null?void 0:M.data.event.title),1),a[8]||(a[8]=t("div",{class:"text-muted-foreground"},"Event sum",-1)),t("div",oe,[t("div",ae,[t("div",ne,[a[2]||(a[2]=t("div",{class:"text-muted-foreground"},"Amount earned",-1)),t("div",re," ₦"+m(("formatMoney"in l?l.formatMoney:e(z))(((B=e(o))==null?void 0:B.data.total_earnings)??0)),1)]),t("div",ie,[t("div",le,[t("div",de,[s(_,{name:"mic",class:"place-center scale-50"})]),a[3]||(a[3]=t("div",{class:"text-lg font-medium"},"Hypes",-1)),t("div",ue,m(((O=(D=(P=(I=(H=e(o))==null?void 0:H.data)==null?void 0:I.event)==null?void 0:P.types)==null?void 0:D.hype)==null?void 0:O.count)??0)+" requests ",1),t("div",ce," ₦"+m(("formatMoney"in l?l.formatMoney:e(z))(((W=(q=(V=(U=(Y=e(o))==null?void 0:Y.data)==null?void 0:U.event)==null?void 0:V.types)==null?void 0:q.hype)==null?void 0:W.total_price)??0)),1)]),t("div",pe,[t("div",me,[s(_,{name:"music",class:"place-center scale-50"})]),a[4]||(a[4]=t("div",{class:"text-lg font-medium"},"Songs",-1)),t("div",_e,m(((K=(J=(X=(G=(j=e(o))==null?void 0:j.data)==null?void 0:G.event)==null?void 0:X.types)==null?void 0:J.song)==null?void 0:K.count)??0)+" requests ",1),t("div",ge," ₦"+m(("formatMoney"in l?l.formatMoney:e(z))(((st=(et=(tt=(Z=(Q=e(o))==null?void 0:Q.data)==null?void 0:Z.event)==null?void 0:tt.types)==null?void 0:et.song)==null?void 0:st.total_price)??0)),1)])])]),t("div",fe,[(u(!0),f(lt,null,dt(e(w),p=>(u(),f("div",{class:"p-4 rounded-2xl bg-white/5 border",key:p.name},[t("div",ve,[t("div",ye,m(p.name),1),t("div",null,m(p.value),1)])]))),128))]),t("div",he,[t("div",be,[a[6]||(a[6]=t("div",{class:"text-lg font-semibold"},"Top Spenders",-1)),s(y,{variant:"ghost",class:"gap-x-2 translate-x-4",id:"SHARE-BUTTON",onClick:e(h)},{default:n(()=>[a[5]||(a[5]=t("div",null,"Share",-1)),s(_,{name:"share"})]),_:1},8,["onClick"])]),t("div",xe,[(u(!0),f(lt,null,dt((ot=e(o))==null?void 0:ot.data.top_spenders,(p,ft)=>(u(),f("div",{class:"grid grid-cols-[10px_1fr_auto] gap-x-2 text-muted-foreground",key:p.user_id},[t("div",Ce,m(ft+1)+".",1),t("div",null,m((p==null?void 0:p.name)??p.email),1),t("div",null,"₦"+m(("formatMoney"in l?l.formatMoney:e(z))(p.total)),1)]))),128)),(rt=(nt=(at=e(o))==null?void 0:at.data)==null?void 0:nt.top_spenders)!=null&&rt.length?wt("",!0):(u(),f("div",Se," Sorry, no one paid for this event. "))])]),t("div",ke,[s(te,{history:(it=e(o))==null?void 0:it.data.price_histories},null,8,["history"])]),t("div",Fe,[s(y,{size:"lg",class:"uppercase",loading:e(r),onClick:b},{default:n(()=>a[7]||(a[7]=[R(" Download Receipt ")])),_:1},8,["loading"]),s(k,{message:"Share to twitter/X"},{default:n(()=>[s(y,{size:"icon",variant:"secondary",class:"!size-[40px]",onClick:a[0]||(a[0]=p=>e(L)(e(gt)))},{default:n(()=>[s(_,{name:"x"})]),_:1})]),_:1}),s(k,{message:"Share to whatsapp"},{default:n(()=>[s(y,{size:"icon",variant:"secondary",class:"!size-[40px]",onClick:a[1]||(a[1]=p=>e(L)(e(_t)))},{default:n(()=>[s(_,{name:"whatsapp",class:"scale-[0.7]"})]),_:1})]),_:1}),s(k,{message:"Copy link"},{default:n(()=>[s(y,{size:"icon",variant:"secondary",class:"!size-[40px]",onClick:e(pt)},{default:n(()=>[e(mt)?(u(),N(e(Gt),{key:0,class:"text-muted-foreground size-4"})):(u(),N(e(Xt),{key:1,class:"text-muted-foreground size-4"}))]),_:1},8,["onClick"])]),_:1})])])],2)]}),_:1},8,["loading","error"])])}}});export{Oe as default};
